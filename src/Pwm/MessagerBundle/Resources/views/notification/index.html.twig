{% extends "AppBundle::table.html.twig" %}
  {% block page_sub_title %}
       <ul class="breadcrumb">
        <li>
          <i class="icon-home"></i>
          <a href="#">Home</a> 
          <i class="icon-angle-right"></i>
        </li>
        <li><a href="#">Communication</a></li>
      </ul>
   {% endblock %}
   {% block table_title %}Messages grand public{% endblock %}  
{% block table %}
        <table class="table table-striped table-bordered bootstrap-datatable datatable" id="my-table-1">
        <thead>
            <tr>
                <th>Titre</th>
                <th>Date</th>
                <th>Destinataire</th>
                <th>Lecture</th>
                <th>Appréciation</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
        {% for notification in notifications %}
            <tr>
                <td>{{ notification.titre }}</td>
                <td>{% if notification.date %}{{ notification.date|date('Y-m-d H:i:s') }}{% endif %}</td>
                <td>{% if notification.groupe %}{{notification.groupe.nom}}{% else %}Tout le monde{% endif %}
                    {% if not notification.sendNow %}
                        <span class="label">
                             {{ render(controller( 'MessagerBundle:Notification:getDestNumber', { 'id': notification.id }))|number_format(0, ',', '.') }}
                        </span>
                   {% else %}
                       <span class="success">{{notification.sendings|length}}</span>
                   {% endif %}
                </td>
                <td><b>{{ render(controller( 'MessagerBundle:Notification:getReading', { 'id': notification.id }))|number_format(0, ',', '.') }}%</b></td>
                <td><b>{{ render(controller( 'MessagerBundle:Notification:getRate', { 'id': notification.id })) }}/5</b></td>
                <td class="center ">
                               <a class="btn btn-success" href="{{ path('notification_show', { 'id': notification.id }) }}">
                                        <i class="halflings-icon white zoom-in"></i>  
                                    </a>
                                {% if not notification.sendNow %}    
                                    <a class="btn btn-info" href="{{ path('notification_edit', { 'id': notification.id }) }}">
                                        <i class="halflings-icon white edit"></i>  
                                    </a>
                               {% endif %}
                        </td>                
            </tr>
        {% endfor %}
        </tbody>
    </table>
    <ul>
        <li>
            <a href="{{ path('notification_new') }}">Créer un nouveau message</a>
        </li>
    </ul>
{% endblock %}
